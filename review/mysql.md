- mysql逻辑架构
一共3层:
1. 服务器层,包括连接处理/认证/安全的功能
2. 查询解析/优化/缓存,存储过程/触发器
3. 存储引擎层,数据的存储/提取

- mysql读写锁
并发访问/写入数据时: 读锁共享,写锁独占
锁的策略: 表锁/行锁(存储引擎实现)

- 死锁解决办法
死锁一般是指多个事务之间以不同顺序抢夺锁回出现的情况
1. innoDB 目前处理死锁的方法是将持有最少行级排它锁的事务进行回滚
2. 设置超时机制

- 事务是什么?
 - 事务是指将多个操作批量处理的过程,整个过程要么成功,要么都回滚
 - ACID: 原子性,一致性,隔离性,永久性
 - 隔离级别: read uncommitted, read committed, repeatable read, serialize
 - 幻读:一个事务在读取一定范围内的行时,会出现有些行出现/不出现的情况,mvvc多版本并发控制解决这个问题
 - mvvc: 多版本并发控制,每行会记录隐藏的列,创建时间,每个事务开始前会获取一个时间戳,在这个时间戳之前的,可以被读取到,之后的就不行
 - 查询执行流程: 1.发个查询语句 2.缓存/解析语句 3.数据读写

-  datetime/timestamp?
  - datetime:存储空间位8B,精度为秒
  - timestamp:unix时间戳,依赖于时区

- 优化策略
  1. 数据类型按需设置
  2. 避免not null(该列会让索引优化很困难,会用更多的存储空间)
  3. 索引: 
    - b-tree: O(logn) 平衡树,普通索引/唯一索引/主键索引 一般用于经常查询的字段
    - hash: 基于hash表实现, O(1), 适用于精确匹配的列
    - 全文索引: 快速搜索文本内容的索引方式 FULLTEXT关键字
  4. 定位低效sql: 
    - 慢查询日志: 查询以后才会记录
    - explain `sql 语句`来查看该语句的执行情况
    - trace

